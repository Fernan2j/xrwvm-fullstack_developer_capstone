<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Best Cars Automotive</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="static/style.css" />
    <link rel="stylesheet" href="static/bootstrap.min.css" />

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <script>
      const logout = async (e) => {
        // Build logout URL and Make GET request to logout endpoint
        let logout_url = window.location.origin + "/djangoapp/logout";
        const res = await fetch(logout_url, {
          method: "GET",
        });

        const json = await res.json();
        if (json) {
          // Clear session storage and reload page
          let username = sessionStorage.getItem("username");
          sessionStorage.removeItem("username");
          window.location.href = window.location.origin;
          window.location.reload();
          // Notify user of logout
          alert("Logging out " + username + "...");
        } else {
          alert("The user could not be logged out.");
        }
      };

      let checkSession = () => {
        let curr_user = sessionStorage.getItem("username");

        // UPDATED: Added Bootstrap classes (nav-item, nav-link) to the injected HTML
        // so they look good on the dark navbar.
        if (curr_user && curr_user !== "") {
          document.getElementById("loginlogout").innerHTML =
            '<span class="nav-item nav-link text-white">Hello, ' +
            curr_user +
            "</span>" +
            '<a class="nav-item nav-link" onclick="logout()" href="#">Logout</a>';
        } else {
          document.getElementById("loginlogout").innerHTML =
            '<a class="nav-item nav-link" href="/login">Login</a>' +
            '<a class="nav-item nav-link" href="/register">Register</a>';
        }
      };
    </script>
  </head>

  <body onload="checkSession()">
    <nav
      class="navbar navbar-expand-lg navbar-dark"
      style="background-color: #003366"
    >
      <div class="container-fluid">
        <h2 class="navbar-brand mb-0 h1" style="padding-right: 20px">
          Best Cars Automotive
        </h2>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarText"
          aria-controls="navbarText"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarText">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a
                class="nav-link active"
                style="font-size: larger"
                aria-current="page"
                href="/"
                >Home</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" style="font-size: larger" href="/about"
                >About Us</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" style="font-size: larger" href="/contact"
                >Contact Us</a
              >
            </li>
          </ul>

          <div class="navbar-nav ml-auto" id="loginlogout"></div>
        </div>
      </div>
    </nav>

    <div class="container mt-5">
      <div class="row justify-content-center">
        <div class="col-12 col-md-8">
          <div class="card shadow border-0">
            <img
              src="static/car_dealer.png"
              class="card-img-top"
              alt="Dealership Showroom"
            />
            <div class="card-body text-center">
              <h5 class="card-title display-6">Welcome to Best Cars!</h5>
              <p class="card-text lead">
                Browse our extensive collection of dealerships to find the
                vehicle of your dreams.
              </p>

              <a
                href="/dealers"
                class="btn btn-lg text-white"
                style="background-color: #003366"
                >View Dealerships</a
              >
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
